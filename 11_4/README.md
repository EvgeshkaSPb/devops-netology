# Домашнее задание к занятию "11.04 Микросервисы: масштабирование"

Вы работаете в крупной компанию, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps специалисту необходимо выдвинуть предложение по организации инфраструктуры, для разработки и эксплуатации.

## Задача 1: Кластеризация

Предложите решение для обеспечения развертывания, запуска и управления приложениями.
Решение может состоять из одного или нескольких программных продуктов и должно описывать способы и принципы их взаимодействия.

Решение должно соответствовать следующим требованиям:
- Поддержка контейнеров;
- Обеспечивать обнаружение сервисов и маршрутизацию запросов;
- Обеспечивать возможность горизонтального масштабирования;
- Обеспечивать возможность автоматического масштабирования;
- Обеспечивать явное разделение ресурсов доступных извне и внутри системы;
- Обеспечивать возможность конфигурировать приложения с помощью переменных среды, в том числе с возможностью безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п.

Обоснуйте свой выбор.

## Ответ

На данный момент сществует достаточное количество готовых решений, соответсвующих требованиям задания.  
Я не вижу смысла внедрять решение из нескольких программных продуктов, это усложняет настройку и обслуживание, а в последствии может привести к проблемам с своместимостью.  
Рассмотрим несколько готовых решений:

| Требования  | Kubernetes | Apache Mesos | Nomad | Docker Swarm |
|:-------------|:---------------:|:-------------:|:-------------:|:-------------:|
|Поддержка контейнеров | Docker, containerd, CRI-O, и любая реализация Kubernetes CRI (Container Runtime Interface)  | Docker, Mesos containerizer | Docker, Podman, LXC, containerd, systemd-nspawn | Docker | 
|Обнаружение сервисов и маршрутизацию запросов | Собственный DNS srver | Собственный DNS srver | с версии 1.3 Nomad API или template Stanza (ранее только Consul) | Собственный DNS srver |
|Возможность горизонтального масштабирования | HorizontalPodAutoscaler | Elastic-Job-Cloud | Nomad Autoscaler | нет auto-scaling, ручное управление Scale the service |
|Возможность автоматического масштабирования | HorizontalPodAutoscaler,VerticalPodAutoscaler, Cluster Autoscaler | нет, доступно с Marathon | Nomad Autoscaler (Horizontal Application Autoscaling, Horizontal Cluster Autoscaling, Dynamic Application Sizing) | Нет |
|Явное разделение ресурсов доступных извне и внутри системы | Services, Namespaces | Pid Namespace Isolator | явной изоляции нет, возможна настройка через Network | overlay networks\Publish |
|Возможность конфигурировать приложения с помощью переменных среды | ДА | ДА | ДА | ДА |
|Возможность безопасного хранения чувствительных данных таких как пароли, ключи доступа, ключи шифрования и т.п. | Да | Да | Нет, возможна с Vault | Да (docker secret)|

Исходя из данной таблицы, оптимальным выбором мне представляется Kubernetes. Данный продукт отвечает всем требованиям, он широко распостранен, имеет большое сообщество и хорошую документацию.  
Остальные продукты в меньшей степени соответсвуют нашим требованиям.
